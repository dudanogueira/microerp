{% extends "frontend/frontend-base.html" %}
{% load sekizai_tags %}
{% load check_installed %}

<title>{%block title %}{{block.super}} - Financeiro{% endblock %}</title>

{% block content %}

<h1><i class="icon-th"></i> <i class="icon-paperclip"></i> Lançamentos a Receber</h1>
<h2>Lançamentos Pendentes</h2>

<table class="table table-striped table-bordered table-hover">
    <thead>
        <tr>
            <th>#</th>
            <th>Cliente</th>
            <th>Valor Cobrado</th>
            <th>Data</th>
            <th>Ações</th>
        </tr>
    </thead>
    <tbody>
        {% for lancamento in lancamentos_pendentes %}
        <tr>
            <td>{{lancamento.id}}</td>
            <td>{{lancamento.contrato.cliente}}<br />
                <strong>Contrato</strong>: #{{lancamento.contrato.id}}<br />
                <strong>Categoria</strong>: {{lancamento.contrato.categoria}}<br />
                <strong>Responsável</strong>: {{lancamento.contrato.responsavel}}
            </td>
            <td>
                <span class="label label-success"><strong>Cobrado</strong>: R$ {{lancamento.valor_cobrado}}</span>
                {% if lancamento.pendente %}
                <br />
                <small>
                    <strong>Juros</strong>: R$ {{lancamento.juros}},
                    <strong>Multa</strong>: R$ {{lancamento.multa}}<br />
                    <span class="label label-important">Total: R$ {{lancamento.total_pendente}}</span>
                </small>
                {% endif %}
            </td>
            <td><strong>Data</strong>: {{lancamento.data_cobranca}}<br /> <small>(<strong>{{lancamento.data_cobranca|timesince}} atrasado</strong>)</small></td>
            <td>
                <a href="{% url "financeiro:lancamentos_a_receber_receber" lancamento.id %}" role="button" valor="{{lancamento.total_pendente}}" modo="{{lancamento.contrato.forma_pagamento}}" class="btn btn-primary" ><i class="icon-thumbs-up"></i> Receber</a>
            </td>
        </tr>
        
        {% empty %}
        <tr>
            <td><small>Nenhum Lançamento Pendente</small></td>
        </tr>
        {% endfor %}

    </tbody>
</table>
{% if lancamentos_pendentes_total.valor_cobrado__sum %}
<hr />
<strong>Total SEM Juros e Multa:</strong> R${{lancamentos_pendentes_total.valor_cobrado__sum}}<br />
<strong>Total COM Juros e Multa:</strong> R${{total_com_juros_e_multa}}
{% endif %}

<h3>Lançamentos Futuros Nesta Semana</h3>
<h4>De {{inicio_semana|date:"SHORT_DATE_FORMAT"}} a {{fim_semana|date:"SHORT_DATE_FORMAT"}}</h4>
<table class="table table-striped table-bordered table-hover">
    <thead>
        <tr>
            <th>#</th>
            <th>Cliente</th>
            <th>Valor Cobrado</th>
            <th>Data</th>
            <th>Ações</th>
        </tr>
    </thead>
    <tbody>
        {% for lancamento in lancamentos_futuros %}
        <tr>
            <td>{{lancamento.id}}</td>
            <td>{{lancamento.contrato.cliente}}<br />
                <strong>Contrato</strong>: #{{lancamento.contrato.id}}<br />
                <strong>Categoria</strong>: {{lancamento.contrato.categoria}}<br />
                <strong>Responsável</strong>: {{lancamento.contrato.responsavel}}
            </td>
            <td>
                <span class="label label-success"><strong>Cobrado</strong>: R$ {{lancamento.valor_cobrado}}</span>
                {% if lancamento.antecipado %}
                <span class="label label-warning"><strong>Antecipado</strong>: R$ {{lancamento.valor_recebido}}</span>
                {% endif %}
            </td>
            <td><strong>Data</strong>: {{lancamento.data_cobranca|date:"SHORT_DATE_FORMAT"}}</td>
            <td>
                {% if lancamento.antecipado %}
                <a href="" class="btn btn-warning disabled">
                    <i class="icon-usd"></i> Antecipado</a>
                </a>
                <a href="{% url "financeiro:lancamentos_a_receber_receber" lancamento.id %}" role="button" valor="{{lancamento.total_pendente}}" modo="{{lancamento.contrato.forma_pagamento}}" class="btn btn-primary" ><i class="icon-thumbs-up"></i> Acusar Pagamento</a>
                
                {% else %}
                    <a href="{% url "financeiro:lancamentos_a_receber_antecipar" lancamento.id %}" class="btn btn-danger">
                        <i class="icon-arrow-left"></i> Antecipar
                    </a>
                    <br />
                    <a href="{% url "financeiro:lancamentos_a_receber_receber" lancamento.id %}" role="button" valor="{{lancamento.total_pendente}}" modo="{{lancamento.contrato.forma_pagamento}}" class="btn btn-primary" ><i class="icon-thumbs-up"></i> Receber</a>
                    
                {% endif %}
                
                
            </td>
            
        </tr>
        {% endfor %}
    </tbody>
</table>
<strong>Soma do Valor Cobrado</strong>: <span class="label label-success">R$ {{soma_lancamentos_futuro.valor_cobrado__sum}}</span>


{% endblock %}

{% block auxiliar-menu %}
{% addtoblock "js" %}
<link href="{{ STATIC_URL }}frontend/css/ui-lightness/jquery-ui-date-picker.min.css" rel="stylesheet">
<script src="{{ STATIC_URL }}frontend/js/jquery-ui-datepicker.js"></script>

<script>
$(document).ready(function() {
    
	$( ".datepicker" ).datepicker({
		inline: true,
        dateFormat: "dd/mm/yy"
        
	});
    
    
	$("#menu-financeiro-lancamentos-a-receber, #top-menu-financeiro").addClass("active");
    
});
</script>
{% endaddtoblock %}
{% include "frontend/financeiro/financeiro-menu.html" %}
{% endblock%}